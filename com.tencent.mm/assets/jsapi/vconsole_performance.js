(function(){var titles=$WF_TITLES$ , data=$WF_DATAS$ , wflog=$WF_LOG$; function __addVConsolePlugin(vConsoleIns){var name='WePerf' , pWxPerf=new VConsole.VConsolePlugin('plugin_wx_perf','Performance'); pWxPerf.on('renderTab', function(callback){callback(getLogDataHtml());}); pWxPerf.on('addTopBar', function(callback){callback([{name: 'Info', className: '', data:{type: 'info'}, onClick: function(){__wxPerfShowTime()}},{name: 'Waterfall', className: '', data:{type: 'waterfall'}, onClick: __wxPerfDrawWaterfall}]);}); vConsoleIns.addPlugin(pWxPerf);}function getLogDataHtml(){return `<div class='vc-table'> <div class='vc-log'> ${wflog.map(function(w){if (w.k=='section'){return `<dl class="vc-table-row"> <dd class="vc-table-col" style="margin-left:40%">${w.v}</dd> </dl>`}else{return `<dl class="vc-table-row"> <dd class="vc-table-col">${w.k}</dd> <dd class="vc-table-col vc-table-col-2">${w.v}</dd> </dl>`}}).join('\n')}</div></div>`;}function __wxPerfShowTime(){document.getElementById("__vc_log_plugin_wx_perf").innerHTML=getLogDataHtml()}function __wxPerfGetWaterfallData(){var slicer=200 , maxX=Math.ceil(Math.max.apply(Math, data) / 500) * 500; while (maxX / slicer < 5 && slicer > 25){slicer=slicer / 2;}var waterfall=[]; titles.forEach(function(title, index){if (title){waterfall.push({title: title, start: data[index * 2] * 100 / maxX, length: (data[index * 2 + 1] - data[index * 2]) * 100 / maxX});}}); var sliceIndex=0; var slicerData=[]; while (sliceIndex * slicer < maxX){var val=sliceIndex * slicer; slicerData.push({start: val * 100 / maxX, time: val}); sliceIndex++;}return{w: waterfall, s: slicerData}}function getWaterFallHtml(){var dummy=document.createElement('div'); dummy.appendChild(getWaterFallContainer()); return dummy.innerHTML}function getWaterFallContainer(){var style=document.createElement('style'); style.innerHTML='.vconsole-waterfall{margin-left: 10%;width: 90%;position: relative;}.vconsole-waterfall .title{z-index:999;margin-left: -10%;width: 10%;display: flex;flex-direction: column;position: absolute;}.vconsole-waterfall .title span{padding-top:2px; height: 25px;}.vconsole-waterfall .data{top:0;position: relative;display: flex;flex-direction: column;}.vconsole-waterfall .data span{margin: 1px 0 1px 0;height: 25px; background-color: orange;}.vconsole-waterfall .slicer{position: absolute;top: 0; left: 0;width: 100%; height: 100%;}.vconsole-waterfall .slicer div{width: 1px; height: 100%;position: absolute;background: black;}.vconsole-waterfall .slicer span{bottom: -35px;left: -5px;position: absolute;}'; (document.head || document.getElementsByTagName('head')[0]).appendChild(style); var data=__wxPerfGetWaterfallData() , waterfall=data.w , slicerData=data.s; var container=document.createElement('div'); container.className='vconsole-waterfall'; container.innerHTML=`<div class="title">${waterfall.map(function(w){return `<span>${w.title}</span>`}).join('\n')}</div><div class="data">${waterfall.map(function(w){return `<span style="margin-left:${w.start}%;width:${w.length}%"></span>`}).join('\n')}</div><div class="slicer">${slicerData.map(function(w){return `<div style="margin-left:${w.start}%;"><span style="transform:rotate(45deg)";>${w.time}ms</span></div>`}).join('\n')}</div>`; return container}function __wxPerfDrawWaterfall(){var parent=document.getElementById("__vc_log_plugin_wx_perf"); parent.innerHTML=''; parent.appendChild(getWaterFallContainer());}if (window.VConsole && window.vConsoleIns){__addVConsolePlugin(window.vConsoleIns);}else{window['__wx_vconsole_plugins__'] ? window['__wx_vconsole_plugins__'].push(__addVConsolePlugin) : (window['__wx_vconsole_plugins__']=[__addVConsolePlugin]);}})(); //var $WF_TITLES$=['WebViewUI','WebView', 'getA8Key', 'initInvoker', null, null, 'DNS', 'FirstPaint','Resource']; //var $WF_DATAS$=[82,266,147,170,317,500,186,255,0,0,0,0,330,330,251,1177,1079,1439];