System.register(["./store.base.js"],(function(){"use strict";var e,t,r,n,a,i,s,o,c,l,u,h,f,p,d,g,m,v,y,b,I,w,R,x,C,k,A,E,L,M,U,S,P,j,O,q,_,T,B,N,D,F,$,H,K,Y,J,z,V,Z,G,W,Q,X,ee,te,re,ne,ae,ie,se,oe,ce,le,ue,he,fe,pe,de,ge,me,ve,ye,be,Ie,we,Re,xe,Ce;return{setters:[function(ke){e=ke._,t=ke.a,r=ke.b,n=ke.f,a=ke.g,i=ke.o,s=ke.c,o=ke.w,c=ke.u,l=ke.d,u=ke.e,h=ke.h,f=ke.i,p=ke.j,d=ke.k,g=ke.r,m=ke.l,v=ke.m,y=ke.t,b=ke.n,I=ke.p,w=ke.q,R=ke.s,x=ke.v,C=ke.x,k=ke.y,A=ke.z,E=ke.A,L=ke.B,M=ke.C,U=ke.D,S=ke.E,P=ke.F,j=ke.G,O=ke.H,q=ke.I,_=ke.J,T=ke.K,B=ke.L,N=ke.M,D=ke.N,F=ke.O,$=ke.P,H=ke.Q,K=ke.R,Y=ke.S,J=ke.T,z=ke.U,V=ke.V,Z=ke.W,G=ke.X,W=ke.Y,Q=ke.Z,X=ke.$,ee=ke.a0,te=ke.a1,re=ke.a2,ne=ke.a3,ae=ke.a4,ie=ke.a5,se=ke.a6,oe=ke.a7,ce=ke.a8,le=ke.a9,ue=ke.aa,he=ke.ab,fe=ke.ac,pe=ke.ad,de=ke.ae,ge=ke.af,me=ke.ag,ve=ke.ah,ye=ke.ai,be=ke.aj,Ie=ke.ak,we=ke.al,Re=ke.am,xe=ke.an,Ce=ke.ao}],execute:function(){var ke=r.includes;e({target:"Array",proto:!0},{includes:function(e){return ke(this,e,arguments.length>1?arguments[1]:void 0)}}),t("includes");var Ae=Function.call,Ee=function(e,t,r){return n(Ae,a[e].prototype[t],r)};Ee("Array","includes");var Le,Me,Ue,Se="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Pe=i.f,je=a.Int8Array,Oe=je&&je.prototype,qe=a.Uint8ClampedArray,_e=qe&&qe.prototype,Te=je&&s(je),Be=Oe&&s(Oe),Ne=Object.prototype,De=(Ne.isPrototypeOf,o("toStringTag")),Fe=c("TYPED_ARRAY_TAG"),$e=c("TYPED_ARRAY_CONSTRUCTOR"),He=Se&&!!l&&"Opera"!==u(a.opera),Ke={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Ye={BigInt64Array:8,BigUint64Array:8},Je=function(e){if(!d(e))return!1;var t=u(e);return p(Ke,t)||p(Ye,t)};for(Le in Ke)(Ue=(Me=a[Le])&&Me.prototype)?h(Ue,$e,Me):He=!1;for(Le in Ye)(Ue=(Me=a[Le])&&Me.prototype)&&h(Ue,$e,Me);if((!He||"function"!=typeof Te||Te===Function.prototype)&&(Te=function(){throw TypeError("Incorrect invocation")},He))for(Le in Ke)a[Le]&&l(a[Le],Te);if((!He||!Be||Be===Ne)&&(Be=Te.prototype,He))for(Le in Ke)a[Le]&&l(a[Le].prototype,Be);if(He&&s(_e)!==Be&&l(_e,Be),f&&!p(Be,De))for(Le in!0,Pe(Be,De,{get:function(){return d(this)?this[Fe]:void 0}}),Ke)a[Le]&&h(a[Le],Fe,Le);var ze=function(e){if(Je(e))return e;throw TypeError("Target is not a typed array")},Ve=function(e,t,r){if(f){if(r)for(var n in Ke){var i=a[n];if(i&&p(i.prototype,e))try{delete i.prototype[e]}catch(e){}}Be[e]&&!r||g(Be,e,r?t:He&&Oe[e]||t)}},Ze=r.includes,Ge=ze;Ve("includes",(function(e){return Ze(Ge(this),e,arguments.length>1?arguments[1]:void 0)}));var We=m((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));v(We);var Qe=I.f,Xe=function(e){return function(t){for(var r,n=y(t),a=b(n),i=a.length,s=0,o=[];i>s;)r=a[s++],f&&!Qe.call(n,r)||o.push(e?[r,n[r]]:n[r]);return o}},et={entries:Xe(!0),values:Xe(!1)},tt=et.values;e({target:"Object",stat:!0},{values:function(e){return tt(e)}}),w.Object.values;var rt=et.entries;e({target:"Object",stat:!0},{entries:function(e){return rt(e)}}),w.Object.entries;var nt=function(e,t,r){var n=R(t);n in e?i.f(e,n,x(0,r)):e[n]=r};e({target:"Object",stat:!0,sham:!f},{getOwnPropertyDescriptors:function(e){for(var t,r,n=y(e),a=k.f,i=C(n),s={},o=0;i.length>o;)void 0!==(r=a(n,t=i[o++]))&&nt(s,t,r);return s}}),w.Object.getOwnPropertyDescriptors;var at=m((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));v(at);var it=function(e){var t=A(E(this)),r="",n=L(e);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(r+=t);return r},st=Math.ceil,ot=function(e){return function(t,r,n){var a,i,s=A(E(t)),o=s.length,c=void 0===n?" ":A(n),l=M(r);return l<=o||""==c?s:((i=it.call(c,st((a=l-o)/c.length))).length>a&&(i=i.slice(0,a)),e?s+i:i+s)}},ct={start:ot(!1),end:ot(!0)},lt=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(U),ut=ct.start;e({target:"String",proto:!0,forced:lt},{padStart:function(e){return ut(this,e,arguments.length>1?arguments[1]:void 0)}}),Ee("String","padStart");var ht=ct.end;e({target:"String",proto:!0,forced:lt},{padEnd:function(e){return ht(this,e,arguments.length>1?arguments[1]:void 0)}}),Ee("String","padEnd");var ft=m((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));v(ft);var pt={f:o},dt=i.f;!function(e){var t=w.Symbol||(w.Symbol={});p(t,e)||dt(t,e,{value:pt.f(e)})}("asyncIterator"),pt.f("asyncIterator");var gt=m((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));v(gt);var mt=Array.isArray||function(e){return"Array"==S(e)},vt=function(e,t,r,a,i,s,o,c){for(var l,u=i,h=0,f=!!o&&n(o,c,3);h<a;){if(h in r){if(l=f?f(r[h],h,t):r[h],s>0&&mt(l))u=vt(e,t,l,M(l.length),u,s-1)-1;else{if(u>=9007199254740991)throw TypeError("Exceed the acceptable array length");e[u]=l}u++}h++}return u},yt=vt,bt=o("species"),It=function(e,t){return new(function(e){var t;return mt(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!mt(t.prototype)?d(t)&&null===(t=t[bt])&&(t=void 0):t=void 0),void 0===t?Array:t}(e))(0===t?0:t)};e({target:"Array",proto:!0},{flatMap:function(e){var t,r=P(this),n=M(r.length);return j(e),(t=It(r,0)).length=yt(t,r,r,n,0,1,e,arguments.length>1?arguments[1]:void 0),t}}),t("flatMap"),Ee("Array","flatMap"),e({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=P(this),r=M(t.length),n=It(t,0);return n.length=yt(n,t,t,r,0,void 0===e?1:L(e)),n}}),t("flat"),Ee("Array","flat");var wt=m((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));v(wt),e({target:"Object",stat:!0},{fromEntries:function(e){var t={};return O(e,(function(e,r){nt(t,e,r)}),{AS_ENTRIES:!0}),t}}),w.Object.fromEntries;var Rt=m((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));v(Rt);var xt="\t\n\v\f\r                　\u2028\u2029\ufeff",Ct="["+xt+"]",kt=RegExp("^"+Ct+Ct+"*"),At=RegExp(Ct+Ct+"*$"),Et=function(e){return function(t){var r=A(E(t));return 1&e&&(r=r.replace(kt,"")),2&e&&(r=r.replace(At,"")),r}},Lt={start:Et(1),end:Et(2),trim:Et(3)},Mt=function(e){return q((function(){return!!xt[e]()||"​᠎"!="​᠎"[e]()||xt[e].name!==e}))},Ut=Lt.end,St=Mt("trimEnd"),Pt=St?function(){return Ut(this)}:"".trimEnd;e({target:"String",proto:!0,forced:St},{trimEnd:Pt,trimRight:Pt}),Ee("String","trimRight");var jt=Lt.start,Ot=Mt("trimStart"),qt=Ot?function(){return jt(this)}:"".trimStart;e({target:"String",proto:!0,forced:Ot},{trimStart:qt,trimLeft:qt}),Ee("String","trimLeft"),Ee("String","trimLeft"),Ee("String","trimRight");var _t=m((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));v(_t);var Tt=i.f,Bt=a.Symbol;if(f&&"function"==typeof Bt&&(!("description"in Bt.prototype)||void 0!==Bt().description)){var Nt={},Dt=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof Dt?new Bt(e):void 0===e?Bt():Bt(e);return""===e&&(Nt[t]=!0),t};_(Dt,Bt);var Ft=Dt.prototype=Bt.prototype;Ft.constructor=Dt;var $t=Ft.toString,Ht="Symbol(test)"==String(Bt("test")),Kt=/^Symbol\((.*)\)[^)]+$/;Tt(Ft,"description",{configurable:!0,get:function(){var e=d(this)?this.valueOf():this,t=$t.call(e);if(p(Nt,e))return"";var r=Ht?t.slice(7,-1):t.replace(Kt,"$1");return""===r?void 0:r}}),e({global:!0,forced:!0},{Symbol:Dt})}var Yt=m((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));v(Yt);var Jt,zt,Vt=function(){var e=T(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},Zt=function(e,t){return RegExp(e,t)},Gt={UNSUPPORTED_Y:q((function(){var e=Zt("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),BROKEN_CARET:q((function(){var e=Zt("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},Wt=q((function(){var e=RegExp(".","string".charAt(0));return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),Qt=q((function(){var e=RegExp("(?<a>b)","string".charAt(5));return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),Xt=D.get,er=RegExp.prototype.exec,tr=B("native-string-replace",String.prototype.replace),rr=er,nr=(Jt=/a/,zt=/b*/g,er.call(Jt,"a"),er.call(zt,"a"),0!==Jt.lastIndex||0!==zt.lastIndex),ar=Gt.UNSUPPORTED_Y||Gt.BROKEN_CARET,ir=void 0!==/()??/.exec("")[1];(nr||ir||ar||Wt||Qt)&&(rr=function(e){var t,r,n,a,i,s,o,c=this,l=Xt(c),u=A(e),h=l.raw;if(h)return h.lastIndex=c.lastIndex,t=rr.call(h,u),c.lastIndex=h.lastIndex,t;var f=l.groups,p=ar&&c.sticky,d=Vt.call(c),g=c.source,m=0,v=u;if(p&&(-1===(d=d.replace("y","")).indexOf("g")&&(d+="g"),v=u.slice(c.lastIndex),c.lastIndex>0&&(!c.multiline||c.multiline&&"\n"!==u.charAt(c.lastIndex-1))&&(g="(?: "+g+")",v=" "+v,m++),r=new RegExp("^(?:"+g+")",d)),ir&&(r=new RegExp("^"+g+"$(?!\\s)",d)),nr&&(n=c.lastIndex),a=er.call(p?r:c,v),p?a?(a.input=a.input.slice(m),a[0]=a[0].slice(m),a.index=c.lastIndex,c.lastIndex+=a[0].length):c.lastIndex=0:nr&&a&&(c.lastIndex=c.global?a.index+a[0].length:n),ir&&a&&a.length>1&&tr.call(a[0],r,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(a[i]=void 0)})),a&&f)for(a.groups=s=N(null),i=0;i<f.length;i++)s[(o=f[i])[0]]=a[o[1]];return a});e({target:"RegExp",proto:!0,forced:/./.exec!==rr},{exec:rr});var sr=o("match"),or=function(e){var t;return d(e)&&(void 0!==(t=e[sr])?!!t:"RegExp"==S(e))},cr=F.charAt,lr=o("matchAll"),ur="RegExp String",hr="RegExp String Iterator",fr=D.set,pr=D.getterFor(hr),dr=RegExp.prototype,gr=dr.exec,mr="".matchAll,vr=!!mr&&!q((function(){"a".matchAll(/./)})),yr=$((function(e,t,r,n){fr(this,{type:hr,regexp:e,string:t,global:r,unicode:n,done:!1})}),ur,(function(){var e=pr(this);if(e.done)return{value:void 0,done:!0};var t=e.regexp,r=e.string,n=function(e,t){var r,n=e.exec;if("function"==typeof n){if("object"!=typeof(r=n.call(e,t)))throw TypeError("Incorrect exec result");return r}return gr.call(e,t)}(t,r);return null===n?{value:void 0,done:e.done=!0}:e.global?(""===A(n[0])&&(t.lastIndex=function(e,t,r){return t+(r?cr(e,t).length:1)}(r,M(t.lastIndex),e.unicode)),{value:n,done:!1}):(e.done=!0,{value:n,done:!1})})),br=function(e){var t,r,n,a,i,s,o=T(this),c=A(e);return t=H(o,RegExp),void 0===(r=o.flags)&&o instanceof RegExp&&!("flags"in dr)&&(r=Vt.call(o)),n=void 0===r?"":A(r),a=new t(t===RegExp?o.source:o,n),i=!!~n.indexOf("g"),s=!!~n.indexOf("u"),a.lastIndex=M(o.lastIndex),new yr(a,c,i,s)};e({target:"String",proto:!0,forced:vr},{matchAll:function(e){var t,r,n=E(this);if(null!=e){if(or(e)&&!~A(E("flags"in dr?e.flags:Vt.call(e))).indexOf("g"))throw TypeError("`.matchAll` does not allow non-global regexes");if(vr)return mr.apply(n,arguments);if(null!=(r=e[lr]))return j(r).call(e,n)}else if(vr)return mr.apply(n,arguments);return t=A(n),new RegExp(e,"g")[lr](t)}}),lr in dr||h(dr,lr,br),Ee("String","matchAll");var Ir=m((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));v(Ir);var wr=m((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));v(wr);(K().Request||{}).prototype={constructor:()=>{}};var Rr=o("iterator"),xr=!q((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach((function(e,n){t.delete("b"),r+=n+e})),!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[Rr]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host})),Cr=Object.assign,kr=Object.defineProperty,Ar=!Cr||q((function(){if(f&&1!==Cr({b:1},Cr(kr({},"a",{enumerable:!0,get:function(){kr(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach((function(e){t[e]=e})),7!=Cr({},e)[r]||b(Cr({},t)).join("")!=n}))?function(e,t){for(var r=P(e),n=arguments.length,a=1,i=J.f,s=I.f;n>a;)for(var o,c=Y(arguments[a++]),l=i?b(c).concat(i(c)):b(c),u=l.length,h=0;u>h;)o=l[h++],f&&!s.call(c,o)||(r[o]=c[o]);return r}:Cr,Er=function(e,t,r,n){try{return n?t(T(r)[0],r[1]):t(r)}catch(t){throw z(e),t}},Lr=function(e){var t,r,a,i,s,o,c=P(e),l="function"==typeof this?this:Array,u=arguments.length,h=u>1?arguments[1]:void 0,f=void 0!==h,p=V(c),d=0;if(f&&(h=n(h,u>2?arguments[2]:void 0,2)),null==p||l==Array&&Z(p))for(r=new l(t=M(c.length));t>d;d++)o=f?h(c[d],d):c[d],nt(r,d,o);else for(s=(i=p.call(c)).next,r=new l;!(a=s.call(i)).done;d++)o=f?Er(i,h,[a.value,d],!0):a.value,nt(r,d,o);return r.length=d,r},Mr=2147483647,Ur=/[^\0-\u007E]/,Sr=/[.\u3002\uFF0E\uFF61]/g,Pr="Overflow: input needs wider integers to process",jr=Math.floor,Or=String.fromCharCode,qr=function(e){return e+22+75*(e<26)},_r=function(e,t,r){var n=0;for(e=r?jr(e/700):e>>1,e+=jr(e/t);e>455;n+=36)e=jr(e/35);return jr(n+36*e/(e+38))},Tr=function(e){var t,r,n=[],a=(e=function(e){for(var t=[],r=0,n=e.length;r<n;){var a=e.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var i=e.charCodeAt(r++);56320==(64512&i)?t.push(((1023&a)<<10)+(1023&i)+65536):(t.push(a),r--)}else t.push(a)}return t}(e)).length,i=128,s=0,o=72;for(t=0;t<e.length;t++)(r=e[t])<128&&n.push(Or(r));var c=n.length,l=c;for(c&&n.push("-");l<a;){var u=Mr;for(t=0;t<e.length;t++)(r=e[t])>=i&&r<u&&(u=r);var h=l+1;if(u-i>jr((Mr-s)/h))throw RangeError(Pr);for(s+=(u-i)*h,i=u,t=0;t<e.length;t++){if((r=e[t])<i&&++s>Mr)throw RangeError(Pr);if(r==i){for(var f=s,p=36;;p+=36){var d=p<=o?1:p>=o+26?26:p-o;if(f<d)break;var g=f-d,m=36-d;n.push(Or(qr(d+g%m))),f=jr(g/m)}n.push(Or(qr(f))),o=_r(s,h,l==c),s=0,++l}}++s,++i}return n.join("")},Br=function(e){var t=V(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return T(t.call(e))},Nr=G("fetch"),Dr=G("Request"),Fr=Dr&&Dr.prototype,$r=G("Headers"),Hr=o("iterator"),Kr="URLSearchParams",Yr="URLSearchParamsIterator",Jr=D.set,zr=D.getterFor(Kr),Vr=D.getterFor(Yr),Zr=/\+/g,Gr=Array(4),Wr=function(e){return Gr[e-1]||(Gr[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},Qr=function(e){try{return decodeURIComponent(e)}catch(t){return e}},Xr=function(e){var t=e.replace(Zr," "),r=4;try{return decodeURIComponent(t)}catch(e){for(;r;)t=t.replace(Wr(r--),Qr);return t}},en=/[!'()~]|%20/g,tn={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},rn=function(e){return tn[e]},nn=function(e){return encodeURIComponent(e).replace(en,rn)},an=function(e,t){if(t)for(var r,n,a=t.split("&"),i=0;i<a.length;)(r=a[i++]).length&&(n=r.split("="),e.push({key:Xr(n.shift()),value:Xr(n.join("="))}))},sn=function(e){this.entries.length=0,an(this.entries,e)},on=function(e,t){if(e<t)throw TypeError("Not enough arguments")},cn=$((function(e,t){Jr(this,{type:Yr,iterator:Br(zr(e).entries),kind:t})}),"Iterator",(function(){var e=Vr(this),t=e.kind,r=e.iterator.next(),n=r.value;return r.done||(r.value="keys"===t?n.key:"values"===t?n.value:[n.key,n.value]),r})),ln=function(){X(this,ln,Kr);var e,t,r,n,a,i,s,o,c,l=arguments.length>0?arguments[0]:void 0,u=this,h=[];if(Jr(u,{type:Kr,entries:h,updateURL:function(){},updateSearchParams:sn}),void 0!==l)if(d(l))if("function"==typeof(e=V(l)))for(r=(t=e.call(l)).next;!(n=r.call(t)).done;){if((s=(i=(a=Br(T(n.value))).next).call(a)).done||(o=i.call(a)).done||!i.call(a).done)throw TypeError("Expected sequence with length 2");h.push({key:A(s.value),value:A(o.value)})}else for(c in l)p(l,c)&&h.push({key:c,value:A(l[c])});else an(h,"string"==typeof l?"?"===l.charAt(0)?l.slice(1):l:A(l))},un=ln.prototype;if(W(un,{append:function(e,t){on(arguments.length,2);var r=zr(this);r.entries.push({key:A(e),value:A(t)}),r.updateURL()},delete:function(e){on(arguments.length,1);for(var t=zr(this),r=t.entries,n=A(e),a=0;a<r.length;)r[a].key===n?r.splice(a,1):a++;t.updateURL()},get:function(e){on(arguments.length,1);for(var t=zr(this).entries,r=A(e),n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){on(arguments.length,1);for(var t=zr(this).entries,r=A(e),n=[],a=0;a<t.length;a++)t[a].key===r&&n.push(t[a].value);return n},has:function(e){on(arguments.length,1);for(var t=zr(this).entries,r=A(e),n=0;n<t.length;)if(t[n++].key===r)return!0;return!1},set:function(e,t){on(arguments.length,1);for(var r,n=zr(this),a=n.entries,i=!1,s=A(e),o=A(t),c=0;c<a.length;c++)(r=a[c]).key===s&&(i?a.splice(c--,1):(i=!0,r.value=o));i||a.push({key:s,value:o}),n.updateURL()},sort:function(){var e,t,r,n=zr(this),a=n.entries,i=a.slice();for(a.length=0,r=0;r<i.length;r++){for(e=i[r],t=0;t<r;t++)if(a[t].key>e.key){a.splice(t,0,e);break}t===r&&a.push(e)}n.updateURL()},forEach:function(e){for(var t,r=zr(this).entries,a=n(e,arguments.length>1?arguments[1]:void 0,3),i=0;i<r.length;)a((t=r[i++]).value,t.key,this)},keys:function(){return new cn(this,"keys")},values:function(){return new cn(this,"values")},entries:function(){return new cn(this,"entries")}},{enumerable:!0}),g(un,Hr,un.entries),g(un,"toString",(function(){for(var e,t=zr(this).entries,r=[],n=0;n<t.length;)e=t[n++],r.push(nn(e.key)+"="+nn(e.value));return r.join("&")}),{enumerable:!0}),Q(ln,Kr),e({global:!0,forced:!xr},{URLSearchParams:ln}),!xr&&"function"==typeof $r){var hn=function(e){if(d(e)){var t,r=e.body;if(u(r)===Kr)return(t=e.headers?new $r(e.headers):new $r).has("content-type")||t.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),N(e,{body:x(0,String(r)),headers:x(0,t)})}return e};if("function"==typeof Nr&&e({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return Nr(e,arguments.length>1?hn(arguments[1]):{})}}),"function"==typeof Dr){var fn=function(e){return X(this,fn,"Request"),new Dr(e,arguments.length>1?hn(arguments[1]):{})};Fr.constructor=fn,fn.prototype=Fr,e({global:!0,forced:!0},{Request:fn})}}var pn,dn={URLSearchParams:ln,getState:zr},gn=F.codeAt,mn=a.URL,vn=dn.URLSearchParams,yn=dn.getState,bn=D.set,In=D.getterFor("URL"),wn=Math.floor,Rn=Math.pow,xn="Invalid scheme",Cn="Invalid host",kn="Invalid port",An=/[A-Za-z]/,En=/[\d+-.A-Za-z]/,Ln=/\d/,Mn=/^0x/i,Un=/^[0-7]+$/,Sn=/^\d+$/,Pn=/^[\dA-Fa-f]+$/,jn=/[\0\t\n\r #%/:<>?@[\\\]^|]/,On=/[\0\t\n\r #/:<>?@[\\\]^|]/,qn=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,_n=/[\t\n\r]/g,Tn=function(e,t){var r,n,a;if("["==t.charAt(0)){if("]"!=t.charAt(t.length-1))return Cn;if(!(r=Nn(t.slice(1,-1))))return Cn;e.host=r}else if(zn(e)){if(t=function(e){var t,r,n=[],a=e.toLowerCase().replace(Sr,".").split(".");for(t=0;t<a.length;t++)r=a[t],n.push(Ur.test(r)?"xn--"+Tr(r):r);return n.join(".")}(t),jn.test(t))return Cn;if(null===(r=Bn(t)))return Cn;e.host=r}else{if(On.test(t))return Cn;for(r="",n=Lr(t),a=0;a<n.length;a++)r+=Yn(n[a],Fn);e.host=r}},Bn=function(e){var t,r,n,a,i,s,o,c=e.split(".");if(c.length&&""==c[c.length-1]&&c.pop(),(t=c.length)>4)return e;for(r=[],n=0;n<t;n++){if(""==(a=c[n]))return e;if(i=10,a.length>1&&"0"==a.charAt(0)&&(i=Mn.test(a)?16:8,a=a.slice(8==i?1:2)),""===a)s=0;else{if(!(10==i?Sn:8==i?Un:Pn).test(a))return e;s=parseInt(a,i)}r.push(s)}for(n=0;n<t;n++)if(s=r[n],n==t-1){if(s>=Rn(256,5-t))return null}else if(s>255)return null;for(o=r.pop(),n=0;n<r.length;n++)o+=r[n]*Rn(256,3-n);return o},Nn=function(e){var t,r,n,a,i,s,o,c=[0,0,0,0,0,0,0,0],l=0,u=null,h=0,f=function(){return e.charAt(h)};if(":"==f()){if(":"!=e.charAt(1))return;h+=2,u=++l}for(;f();){if(8==l)return;if(":"!=f()){for(t=r=0;r<4&&Pn.test(f());)t=16*t+parseInt(f(),16),h++,r++;if("."==f()){if(0==r)return;if(h-=r,l>6)return;for(n=0;f();){if(a=null,n>0){if(!("."==f()&&n<4))return;h++}if(!Ln.test(f()))return;for(;Ln.test(f());){if(i=parseInt(f(),10),null===a)a=i;else{if(0==a)return;a=10*a+i}if(a>255)return;h++}c[l]=256*c[l]+a,2!=++n&&4!=n||l++}if(4!=n)return;break}if(":"==f()){if(h++,!f())return}else if(f())return;c[l++]=t}else{if(null!==u)return;h++,u=++l}}if(null!==u)for(s=l-u,l=7;0!=l&&s>0;)o=c[l],c[l--]=c[u+s-1],c[u+--s]=o;else if(8!=l)return;return c},Dn=function(e){var t,r,n,a;if("number"==typeof e){for(t=[],r=0;r<4;r++)t.unshift(e%256),e=wn(e/256);return t.join(".")}if("object"==typeof e){for(t="",n=function(e){for(var t=null,r=1,n=null,a=0,i=0;i<8;i++)0!==e[i]?(a>r&&(t=n,r=a),n=null,a=0):(null===n&&(n=i),++a);return a>r&&(t=n,r=a),t}(e),r=0;r<8;r++)a&&0===e[r]||(a&&(a=!1),n===r?(t+=r?":":"::",a=!0):(t+=e[r].toString(16),r<7&&(t+=":")));return"["+t+"]"}return e},Fn={},$n=Ar({},Fn,{" ":1,'"':1,"<":1,">":1,"`":1}),Hn=Ar({},$n,{"#":1,"?":1,"{":1,"}":1}),Kn=Ar({},Hn,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Yn=function(e,t){var r=gn(e,0);return r>32&&r<127&&!p(t,e)?e:encodeURIComponent(e)},Jn={ftp:21,file:null,http:80,https:443,ws:80,wss:443},zn=function(e){return p(Jn,e.scheme)},Vn=function(e){return""!=e.username||""!=e.password},Zn=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},Gn=function(e,t){var r;return 2==e.length&&An.test(e.charAt(0))&&(":"==(r=e.charAt(1))||!t&&"|"==r)},Wn=function(e){var t;return e.length>1&&Gn(e.slice(0,2))&&(2==e.length||"/"===(t=e.charAt(2))||"\\"===t||"?"===t||"#"===t)},Qn=function(e){var t=e.path,r=t.length;!r||"file"==e.scheme&&1==r&&Gn(t[0],!0)||t.pop()},Xn=function(e){return"."===e||"%2e"===e.toLowerCase()},ea={},ta={},ra={},na={},aa={},ia={},sa={},oa={},ca={},la={},ua={},ha={},fa={},pa={},da={},ga={},ma={},va={},ya={},ba={},Ia={},wa=function(e,t,r,n){var a,i,s,o,c,l=r||ea,u=0,h="",f=!1,d=!1,g=!1;for(r||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace(qn,"")),t=t.replace(_n,""),a=Lr(t);u<=a.length;){switch(i=a[u],l){case ea:if(!i||!An.test(i)){if(r)return xn;l=ra;continue}h+=i.toLowerCase(),l=ta;break;case ta:if(i&&(En.test(i)||"+"==i||"-"==i||"."==i))h+=i.toLowerCase();else{if(":"!=i){if(r)return xn;h="",l=ra,u=0;continue}if(r&&(zn(e)!=p(Jn,h)||"file"==h&&(Vn(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=h,r)return void(zn(e)&&Jn[e.scheme]==e.port&&(e.port=null));h="","file"==e.scheme?l=pa:zn(e)&&n&&n.scheme==e.scheme?l=na:zn(e)?l=oa:"/"==a[u+1]?(l=aa,u++):(e.cannotBeABaseURL=!0,e.path.push(""),l=ya)}break;case ra:if(!n||n.cannotBeABaseURL&&"#"!=i)return xn;if(n.cannotBeABaseURL&&"#"==i){e.scheme=n.scheme,e.path=n.path.slice(),e.query=n.query,e.fragment="",e.cannotBeABaseURL=!0,l=Ia;break}l="file"==n.scheme?pa:ia;continue;case na:if("/"!=i||"/"!=a[u+1]){l=ia;continue}l=ca,u++;break;case aa:if("/"==i){l=la;break}l=va;continue;case ia:if(e.scheme=n.scheme,i==pn)e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query=n.query;else if("/"==i||"\\"==i&&zn(e))l=sa;else if("?"==i)e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query="",l=ba;else{if("#"!=i){e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.path.pop(),l=va;continue}e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query=n.query,e.fragment="",l=Ia}break;case sa:if(!zn(e)||"/"!=i&&"\\"!=i){if("/"!=i){e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,l=va;continue}l=la}else l=ca;break;case oa:if(l=ca,"/"!=i||"/"!=h.charAt(u+1))continue;u++;break;case ca:if("/"!=i&&"\\"!=i){l=la;continue}break;case la:if("@"==i){f&&(h="%40"+h),f=!0,s=Lr(h);for(var m=0;m<s.length;m++){var v=s[m];if(":"!=v||g){var y=Yn(v,Kn);g?e.password+=y:e.username+=y}else g=!0}h=""}else if(i==pn||"/"==i||"?"==i||"#"==i||"\\"==i&&zn(e)){if(f&&""==h)return"Invalid authority";u-=Lr(h).length+1,h="",l=ua}else h+=i;break;case ua:case ha:if(r&&"file"==e.scheme){l=ga;continue}if(":"!=i||d){if(i==pn||"/"==i||"?"==i||"#"==i||"\\"==i&&zn(e)){if(zn(e)&&""==h)return Cn;if(r&&""==h&&(Vn(e)||null!==e.port))return;if(o=Tn(e,h))return o;if(h="",l=ma,r)return;continue}"["==i?d=!0:"]"==i&&(d=!1),h+=i}else{if(""==h)return Cn;if(o=Tn(e,h))return o;if(h="",l=fa,r==ha)return}break;case fa:if(!Ln.test(i)){if(i==pn||"/"==i||"?"==i||"#"==i||"\\"==i&&zn(e)||r){if(""!=h){var b=parseInt(h,10);if(b>65535)return kn;e.port=zn(e)&&b===Jn[e.scheme]?null:b,h=""}if(r)return;l=ma;continue}return kn}h+=i;break;case pa:if(e.scheme="file","/"==i||"\\"==i)l=da;else{if(!n||"file"!=n.scheme){l=va;continue}if(i==pn)e.host=n.host,e.path=n.path.slice(),e.query=n.query;else if("?"==i)e.host=n.host,e.path=n.path.slice(),e.query="",l=ba;else{if("#"!=i){Wn(a.slice(u).join(""))||(e.host=n.host,e.path=n.path.slice(),Qn(e)),l=va;continue}e.host=n.host,e.path=n.path.slice(),e.query=n.query,e.fragment="",l=Ia}}break;case da:if("/"==i||"\\"==i){l=ga;break}n&&"file"==n.scheme&&!Wn(a.slice(u).join(""))&&(Gn(n.path[0],!0)?e.path.push(n.path[0]):e.host=n.host),l=va;continue;case ga:if(i==pn||"/"==i||"\\"==i||"?"==i||"#"==i){if(!r&&Gn(h))l=va;else if(""==h){if(e.host="",r)return;l=ma}else{if(o=Tn(e,h))return o;if("localhost"==e.host&&(e.host=""),r)return;h="",l=ma}continue}h+=i;break;case ma:if(zn(e)){if(l=va,"/"!=i&&"\\"!=i)continue}else if(r||"?"!=i)if(r||"#"!=i){if(i!=pn&&(l=va,"/"!=i))continue}else e.fragment="",l=Ia;else e.query="",l=ba;break;case va:if(i==pn||"/"==i||"\\"==i&&zn(e)||!r&&("?"==i||"#"==i)){if(".."===(c=(c=h).toLowerCase())||"%2e."===c||".%2e"===c||"%2e%2e"===c?(Qn(e),"/"==i||"\\"==i&&zn(e)||e.path.push("")):Xn(h)?"/"==i||"\\"==i&&zn(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&Gn(h)&&(e.host&&(e.host=""),h=h.charAt(0)+":"),e.path.push(h)),h="","file"==e.scheme&&(i==pn||"?"==i||"#"==i))for(;e.path.length>1&&""===e.path[0];)e.path.shift();"?"==i?(e.query="",l=ba):"#"==i&&(e.fragment="",l=Ia)}else h+=Yn(i,Hn);break;case ya:"?"==i?(e.query="",l=ba):"#"==i?(e.fragment="",l=Ia):i!=pn&&(e.path[0]+=Yn(i,Fn));break;case ba:r||"#"!=i?i!=pn&&("'"==i&&zn(e)?e.query+="%27":e.query+="#"==i?"%23":Yn(i,Fn)):(e.fragment="",l=Ia);break;case Ia:i!=pn&&(e.fragment+=Yn(i,$n))}u++}},Ra=function(e){var t,r,n=X(this,Ra,"URL"),a=arguments.length>1?arguments[1]:void 0,i=A(e),s=bn(n,{type:"URL"});if(void 0!==a)if(a instanceof Ra)t=In(a);else if(r=wa(t={},A(a)))throw TypeError(r);if(r=wa(s,i,null,t))throw TypeError(r);var o=s.searchParams=new vn,c=yn(o);c.updateSearchParams(s.query),c.updateURL=function(){s.query=String(o)||null},f||(n.href=Ca.call(n),n.origin=ka.call(n),n.protocol=Aa.call(n),n.username=Ea.call(n),n.password=La.call(n),n.host=Ma.call(n),n.hostname=Ua.call(n),n.port=Sa.call(n),n.pathname=Pa.call(n),n.search=ja.call(n),n.searchParams=Oa.call(n),n.hash=qa.call(n))},xa=Ra.prototype,Ca=function(){var e=In(this),t=e.scheme,r=e.username,n=e.password,a=e.host,i=e.port,s=e.path,o=e.query,c=e.fragment,l=t+":";return null!==a?(l+="//",Vn(e)&&(l+=r+(n?":"+n:"")+"@"),l+=Dn(a),null!==i&&(l+=":"+i)):"file"==t&&(l+="//"),l+=e.cannotBeABaseURL?s[0]:s.length?"/"+s.join("/"):"",null!==o&&(l+="?"+o),null!==c&&(l+="#"+c),l},ka=function(){var e=In(this),t=e.scheme,r=e.port;if("blob"==t)try{return new Ra(t.path[0]).origin}catch(e){return"null"}return"file"!=t&&zn(e)?t+"://"+Dn(e.host)+(null!==r?":"+r:""):"null"},Aa=function(){return In(this).scheme+":"},Ea=function(){return In(this).username},La=function(){return In(this).password},Ma=function(){var e=In(this),t=e.host,r=e.port;return null===t?"":null===r?Dn(t):Dn(t)+":"+r},Ua=function(){var e=In(this).host;return null===e?"":Dn(e)},Sa=function(){var e=In(this).port;return null===e?"":String(e)},Pa=function(){var e=In(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},ja=function(){var e=In(this).query;return e?"?"+e:""},Oa=function(){return In(this).searchParams},qa=function(){var e=In(this).fragment;return e?"#"+e:""},_a=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(f&&ee(xa,{href:_a(Ca,(function(e){var t=In(this),r=A(e),n=wa(t,r);if(n)throw TypeError(n);yn(t.searchParams).updateSearchParams(t.query)})),origin:_a(ka),protocol:_a(Aa,(function(e){var t=In(this);wa(t,A(e)+":",ea)})),username:_a(Ea,(function(e){var t=In(this),r=Lr(A(e));if(!Zn(t)){t.username="";for(var n=0;n<r.length;n++)t.username+=Yn(r[n],Kn)}})),password:_a(La,(function(e){var t=In(this),r=Lr(A(e));if(!Zn(t)){t.password="";for(var n=0;n<r.length;n++)t.password+=Yn(r[n],Kn)}})),host:_a(Ma,(function(e){var t=In(this);t.cannotBeABaseURL||wa(t,A(e),ua)})),hostname:_a(Ua,(function(e){var t=In(this);t.cannotBeABaseURL||wa(t,A(e),ha)})),port:_a(Sa,(function(e){var t=In(this);Zn(t)||(""==(e=A(e))?t.port=null:wa(t,e,fa))})),pathname:_a(Pa,(function(e){var t=In(this);t.cannotBeABaseURL||(t.path=[],wa(t,A(e),ma))})),search:_a(ja,(function(e){var t=In(this);""==(e=A(e))?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",wa(t,e,ba)),yn(t.searchParams).updateSearchParams(t.query)})),searchParams:_a(Oa),hash:_a(qa,(function(e){var t=In(this);""!=(e=A(e))?("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",wa(t,e,Ia)):t.fragment=null}))}),g(xa,"toJSON",(function(){return Ca.call(this)}),{enumerable:!0}),g(xa,"toString",(function(){return Ca.call(this)}),{enumerable:!0}),mn){var Ta=mn.createObjectURL,Ba=mn.revokeObjectURL;Ta&&g(Ra,"createObjectURL",(function(e){return Ta.apply(mn,arguments)})),Ba&&g(Ra,"revokeObjectURL",(function(e){return Ba.apply(mn,arguments)}))}Q(Ra,"URL"),e({global:!0,forced:!xr,sham:!f},{URL:Ra}),e({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}}),w.URL;class Na{constructor(e,t,r={}){this.handleMap={},this.isDestroy=!1,this.instance=e,this.afterReceiveHook=r.afterReceiveHook,t.forEach((e=>{this.handleMap[e.name]=e.handler}))}destroy(){this.isDestroy=!0}receive(e){if(this.isDestroy)return void te.error("实例已经销毁，无法接收调用");if(!this.instance.isReady)throw new Error("实例未加载");let t=[];for(let r of e){let e,n=this.handleMap[r.name];if(n)try{e=n(this.instance,...r.args||[])}catch(e){re().baseLibApi.reportError(this.instance.id,e.name,e.message,e.stack),this.instance.receiver.receive([{name:ne.globalEvent,args:["error",[e,"uncaughtException"]]}])}t.push(e)}return this.afterReceiveHook&&this.afterReceiveHook(),JSON.stringify(t)}}class Da{constructor(){this.lastCallbackId=0,this.callbacks=[]}add(e){this.lastCallbackId<1e9?this.lastCallbackId++:this.lastCallbackId=1;let t=this.lastCallbackId;return this.callbacks[t]=e,e.__dispose=()=>{this.remove(t)},t}remove(e){let t;if(ae(e))t=this.callbacks[e],delete this.callbacks[e];else{const r=this.callbacks.findIndex(e);t=this.callbacks[r],delete this.callbacks[r]}return t}trigger(e,t,r=!1){const n=this.callbacks[e];if(r||delete this.callbacks[e],"function"==typeof n)return ie(t)?n.apply(null,t):n.call(null,t);throw new Error("callback not found: "+e)}destroy(){this.callbacks=[]}}class Fa extends class{constructor(e={}){this.moduleSnapshotConfig=e,this.requireNumber=0,this.register=he.getInstance(),this.localModuleBuilders={}}get moduleNames(){return Object.keys(this.localModuleBuilders).concat(this.register.publicModuleNames)}add(e,t){this.localModuleBuilders[e]=t}requireModule(e,t){if(this.localModuleBuilders[t])return this.requireNumber++,this.bindLocalModules(e,this.localModuleBuilders[t]);const r=this.register.modulesInfo[t];return r&&!r.private?(this.requireNumber++,this.bindRegisterModules(e,t,this.register.modulesInfo[t])):void 0}bingRegisterModuleMethods(e,t,r,n){const a=n.methods;for(const i of a)this.bingRegisterModuleMethod(e,t,r,i,n)}bingRegisterModuleAccessorProps(e,t,r){const n=r.accessorProps;if(n)for(const a of n){let n=a.name[0].toUpperCase()+a.name.slice(1),i=`get${n}`,s=a.setter?`set${n}`:"";Object.defineProperty(t,a.name,{enumerable:!0,configurable:!0,get:()=>e.apiCenter.callApi(fe.global,{globalKey:r.bridge.name,methodInfo:{name:i,result:a.getter.result,params:[]},method:i,args:[]}),set:s?t=>e.apiCenter.callApi(fe.global,{globalKey:r.bridge.name,methodInfo:{name:s,params:a.setter&&[a.setter.param]},method:s,args:[t]}):void 0})}}bindRegisterModules(e,t,r){const n={},a=r.bridge,i=this.moduleSnapshotConfig[t],s="global"===a.type?fe.global:fe.dynamic;i&&(n.__lite__={snapshotConfig:i,snapshotCallLastCallMap:{},replay:t=>{for(let n of t){let t=r.methods.find((e=>e.name===n.method));t?e.apiCenter.callApi(s,{globalKey:a.name,methodInfo:t,method:t.name,args:n.args}):te.error("[view] replay module record with method not exist")}}}),this.bingRegisterModuleMethods(e,n,t,r),this.bingRegisterModuleAccessorProps(e,n,r);const o=r.props;return Object.assign(n,o),n}bindLocalModules(e,t){return t(e)}requirePrivateModule(e,t){if(this.register.modulesInfo[t])return this.bindRegisterModules(e,t,this.register.modulesInfo[t])}bingRegisterModuleMethod(e,t,r,n,a){let i;if("global"===a.bridge.type)if(t.__lite__&&t.__lite__.snapshotConfig[n.name]&&t.__lite__.snapshotConfig[n.name].type===pe.lastCall){const r=t.__lite__.snapshotCallLastCallMap;i=(...t)=>(r[n.name]={method:n.name,args:t},e.apiCenter.callApi(fe.global,{globalKey:a.bridge.name,methodInfo:n,method:n.name,args:t}))}else i=(...t)=>e.apiCenter.callApi(fe.global,{globalKey:a.bridge.name,methodInfo:n,method:n.name,args:t});else i=(...t)=>e.apiCenter.callApi(fe.dynamic,{moduleName:r,methodInfo:n,method:n.name,args:t});Object.defineProperty(t,n.name,{enumerable:!1,configurable:!1,get:()=>i})}}{static getInstance(){return Fa.instance||(Fa.instance=new Fa),Fa.instance}}class $a extends class{constructor(e,t=[]){this.methodNames=["requireLib","requireModule","addEventListener","removeEventListener"];const r=this.methodNames.concat(e.moduleManager.moduleNames,t);return this.instance=e,new Proxy(this,{ownKeys:()=>r,getOwnPropertyDescriptor(e,t){if(de(t))return e.methodNames.indexOf(t)>-1?{enumerable:!1,configurable:!0}:{enumerable:!0,configurable:!0}},get(e,t){let r=Reflect.get(e,t);return ce(r)&&de(t)&&(r=e.requireModule(t)),r},set:()=>!1})}requireLib(e){return this.instance.dynamicImport.call(this.instance,e)}requireModule(e){return this.instance.requireModule(e)}addEventListener(e,t){this.instance.globalEventManager.addEventListener(e,t)}removeEventListener(e,t){this.instance.globalEventManager.removeEventListener(e,t)}}{constructor(e){super(e,[])}}class Ha extends class{constructor(e){const t=re();this.Promise=le(e.runtimeProps),this.URL=t.URL,this.debugData=e.debugData,this.fetch=ue(e.runtimeProps)}}{constructor(e){super(e),this.setTimeout=e.wrapTimer("setTimeout"),this.setInterval=e.wrapTimer("setInterval"),this.lite=new $a(e)}}class Ka{constructor(e){this.instanceManager=e,this.listen()}setUp(e){this.matcher=new RegExp(`${we}(\\w+)_${e.uuid}__`)}dispatchError(e,t){t&&this.instanceManager.receive(t.instanceId,e)}reportError(e,t,r){r?re().baseLibApi.reportError(r.instanceId,e,t.message,t.stack):re().baseLibApi.reportError(0,e,t.message,t.stack)}stackParse(e){if(!this.matcher)throw new Error("need setUp");if(!e||!e.stack)return;let t=e.stack.match(this.matcher);if(!t)return;let r=t[1];return{instanceId:parseInt(r,10)}}errorHandle(e,t,r){let n=[{name:ne.globalEvent,args:["error",[r,"unhandledRejection",t]]}];if(t&&!ce(t.id))try{this.instanceManager.receive(t.id,n)}finally{r?re().baseLibApi.reportError(t.id,e,r.message||r.toString(),r.stack):re().baseLibApi.reportError(t.id,e,"no reason","")}else{let t=this.stackParse(r);this.dispatchError(n,t),this.reportError(e,r,t)}}listen(){re().onunhandledrejection=({promise:e,reason:t})=>{this.errorHandle("promise",e,t)},re().wxajs.setPromiseRejectCallback(((e,t,r)=>{try{this.errorHandle(e||"promise",t,r)}catch(e){re().baseLibApi.reportError(0,"system",e.message,e.stack)}}))}}const Ya={createInstanceContext:()=>({}),destroyInstance(){},refreshInstance(){}},Ja=he.getInstance();!function(e,t){const r=re();t.NotFramework=Ya,Object.assign(r,{runInInstance:(t,r)=>e.runCodeInInstance({id:t,resource:r}),createInstance:(r,n,a)=>e.createInstance({id:r,resource:n,config:a,framework:t[a.frameworkType]}),destroyInstance:t=>{e.destroyInstance(t)},callJS:(t,r)=>e.receive(t,r),register(e){Ja.register(e)},loadFramework:e=>re().System.import(e),setUp(r){e.setUp(r);for(const r in t)r!==Ce.NotFramework&&e.preparePreCreateInstance({framework:t[r],config:{frameworkType:r}})}})}(new class{constructor(e){this.runtimeConfig={baseLibInfo:{version:"1.5.2",buildTarget:"undefined",buildType:"production"}},this.preCreateInstanceNum=0,this.instanceMap={},this.preCreateInstanceCache={},this.currentLocalInstanceId=1e4,this.InstanceType=e.InstanceType,this.contextTransform=e.contextTransform,e.AsyncErrorDetector?this.asyncErrorDetector=new e.AsyncErrorDetector(this):this.asyncErrorDetector=new Ka(this)}get uniqLocalId(){return this.currentLocalInstanceId++}setUp(e){if(!e.runnerConfig)throw new Error("初始化缺少参数： runnerConfig");this.asyncErrorDetector.setUp(e.runnerConfig),this.runtimeConfig.hostInfo=e.hostInfo,this.runtimeConfig.runnerConfig=e.runnerConfig}receive(e,t){let r=this.findRuntimeInstance(e);if(r)return r.instance.receiver.receive(t)}findRuntimeInstance(e){return this.instanceMap[e]}destroyInstance(e){const t=this.instanceMap[e];t&&(t.framework.destroyInstance(e),t.instance.destroy(),Re.reportRuntimeInfo(t.instance.reportInfo),delete this.instanceMap[e])}createInstance(e){if(this.instanceMap[e.id])throw new Error(`The instance id "${e.id}" has already been used!`);let t=this.getPreCreateInstance(e);return t.instance.startUp(e.id,{name:e.resource.name,config:e.config}),this.instanceMap[e.id]=t,this.runInContext(e.resource,t),t.instance.afterRunCode(),setTimeout((()=>{this.preparePreCreateInstance(e)}),50),t}runCodeInInstance(e){const t=this.findRuntimeInstance(e.id);if(ce(t))throw new Error("请先创建实例");this.runInContext(e.resource,t)}preparePreCreateInstance(e){let t=this.preCreateInstanceCache[e.config.frameworkType];for(t||(t=this.preCreateInstanceCache[e.config.frameworkType]=[]);t.length<this.preCreateInstanceNum;)t.push(this.preCreateInstance(e))}runCodeInContext(e,t){e.call(t.context,t.context)}getPreCreateInstance(e){let t=this.preCreateInstanceCache[e.config.frameworkType];return t&&xe(t)?t.pop():this.preCreateInstance(e)}preCreateInstance(e){let t=new this.InstanceType({localId:this.uniqLocalId,config:e.config,runtimeConfig:this.runtimeConfig,execLib:e=>{this.runLibInContext(e,n)}});const r=this.createInstanceContext(e.framework,t),n={instance:t,framework:e.framework,context:r};return n}runLibInContext(e,t){let r={exports:{}};return e.code.call(t.context,r,t.context),t.instance.libsMap[e.name]=r.exports}runInContext(e,t){if(e.libs)for(const r of e.libs)this.runLibInContext(r,t);Object.seal(t.instance),Object.seal(t),e.code&&this.runCodeInContext(e.code,t)}createInstanceContext(e,t){let r=t.getContext(),n=r;return this.contextTransform&&(n=this.contextTransform(t,n)),Object.assign(n,e.createInstanceContext(t.localId,r,t),{globalThis:n,global:n,self:n}),n}}({InstanceType:class extends class{constructor(e){this.reportInfo={},this.id=-9999,this.runtimeProps={},this.runtimeContext={},this.callbackManager=new Da,this.syncCallManager=new se,this.isReady=!1,this.libsMap={},this.debugData={},this.name="unnamed",this.moduleCache={},this.currentUniqueId=1,this.timerDisposers={setTimeout:[],setInterval:[]},"localId"in e?this.localId=e.localId:(this.id=e.id,this.localId=e.id,this.isReady=!0),this.execLib=e.execLib,this.baseLibModule=oe(this),this.config=e.config,this.runtimeConfig=e.runtimeConfig}setRuntimeContext(e){this.runtimeContext=e}wrapTimer(e,t){let r=this.timerDisposers[e];return(n,a,...i)=>{let s=re()[e].call(null,(()=>{try{n(),t&&t()}catch(e){this.receiver.receive([{name:ne.globalEvent,args:["error",[e,"uncaughtException"]]}]),re().baseLibApi.reportError(this.id,"timer",e.message,e.stack)}r.splice(r.indexOf(s),1)}),a,...i);return r.push(s),s}}startUp(e,{name:t}){this.id=e,this.runtimeProps.id=e,this.isReady=!0,t&&(this.name=t),this.apiCenter.startUp()}uniqueId(){return this.currentUniqueId++}destroy(){this.reportInfo.callbackNumAtDestroy=this.callbackManager.callbacks.length,this.reportInfo.moduleRequireNumber=this.moduleManager.requireNumber,this.timerDisposers.setTimeout.forEach((e=>{re().clearTimeout(e)})),this.timerDisposers.setInterval.forEach((e=>{re().clearInterval(e)})),this.receiver.destroy(),this.apiCenter.destroy(),this.injectContext.Promise.destroy()}debugMode(){}afterRunCode(){this.reportInfo.callbackNumAtFirstRun=this.callbackManager.callbacks.length}requirePrivateModule(e){let t=this.moduleCache[e];return ce(t)&&(t=this.moduleManager.requirePrivateModule(this,e),t&&(this.moduleCache[e]=t)),t}requireModule(e){let t=this.moduleCache[e];return ce(t)&&(t=Object.seal(this.moduleManager.requireModule(this,e)),t&&(this.moduleCache[e]=t)),t}dynamicImport(e){return new Promise(((t,r)=>{ce(this.libsMap[e])?this.baseLibModule.loadLib(e,((n,a)=>{n||!a?r(n):t(this.libsMap[e])})):t(this.libsMap[e])}))}}{constructor(e){super(e),this.reportInfo.type="store",this.apiCenter=new ge({callbackManager:this.callbackManager,instance:this}),this.receiver=new Na(this,[me,ve,ye]),this.moduleManager=Fa.getInstance(),this.globalEventManager=new be(this),this.injectContext=new Ha(this)}startUp(e,t){super.startUp(e,t),Ie.start(`Store startUp${this.id}`)}destroy(){super.destroy()}getContext(){return this.injectContext}}}),re().frameworks)}}}));
